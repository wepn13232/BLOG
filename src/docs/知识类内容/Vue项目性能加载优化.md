# Vue项目性能加载优化

在Vue开发中，通常是开发完之后进行项目的打包，打包的文件有：vendor.js、app.js、app.css等，但是如果vendor体积过大的话，将会拖慢网页加载的速度，特别是首屏加载的速度问题特别明显（也有可能是导致首页白屏的一个原因）。


### 减少Vendor体积
所以为了解决这个问题，我们将需要减少vendor文件的体积大小。


在webpack.base.conf.js新增externals配置，表示不需要打包的文件，然后在index.html中通过CDN引入。
> 意思就是设置好的externals里面的内容，是以外部引入的方式加载，而不是打包到vendor.js

```javascript
externals: {
    "vue": "Vue",
    "vue-router": "VueRouter",
    "vuex": "Vuex",
    "element-ui": "ELEMENT",
    "BMap": "BMap"
  }
```
> 同时也有另外一个方案，因为vue项目打包之后会生成.map文件，如果将webpack里面的productionSourceMap属性设置为false就可以不生成.map文件。



设置完成之后，将main.js等文件中的import取消掉，但是还是要保留Vue.use等字段

---

### 路由懒加载
另外一种方法就是路由的懒加载，在首页加载的时候减少不必要的路由加载，只需要加载目前需要的路由即可。


在路由文件中，取消掉import引入，使用如下方式加载
```javascript
component:(resolve) => require(['@/pages/home'],resolve);
```

---

### 页面内容懒加载
如果页面的内容或者请求的接口较多，可以参考我之前写的页面滚动懒加载接口，结合这个来进行针对页面的接口请求优化，较少页面加载时请求的接口数，加快页面的渲染。


同时如果页面的图片较多，也可以使用图片懒加载的方式，来减少页面渲染时的压力，加快页面渲染的速度。

---

### SSR（服务端渲染）
为了首页的加载速度加快，可以考虑将首页的html等片段放在服务端中提前渲染，也是使用到了SSR技术，这样的话服务端能提前将首页的内容渲染好直接发送至前端中。

---

### 资源加载
如果是第三方的资源，可以使用cdn加载方式来加载，或者将第三方资源放置服务器中，线上的项目直接本地引用即可，就没有必要使用项目文件来直接加载第三方的资源文件，减少加载请求。

---

### 用户体验
在用户体验上这一块，可以使用loading、骨架屏等方式，先提前渲染页面的架构，等待接口数据的返回和渲染完成即可，但是加载的时间不宜超过5s以上。
